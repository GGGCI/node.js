<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
		<script src="upload.js"></script>
		<script src="download.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<title>文件上傳下載</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<style>
			/*  */
					.upload>span:first-child{   
						color:rgb(248, 242, 242);
						border-radius: 5px;
						padding: 5px 10px;
						background-color: rgb(60, 6, 148);
					}
					.upload>span:first-child:hover{
						background-color: rgb(15, 15, 15);
						color: rgb(226, 223, 24);
					}
		
				</style>
	</head>
	<body class="is-preload">

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header">
						<h1><p>TFHE-POLICE</p>
							
						</h1>
					</header>

				<!-- Menu -->
				
				
				<!-- Wrapper -->
					<section id="wrapper">
						<header>
							<div class="inner">
								<h2>使用說明</h2>
								1. 先選擇下拉式選單要執行的選項
								<br><br>
								2. 之後上傳所需要的檔案
								<br><br>
								3. 上傳完之後即可下載所需要的檔案
								<br><br>
								<h2>資料上傳</h2>
								
								  <form action="/uploads" method="post" enctype="multipart/form-data"id="form" name="form1">
									<p></p>
									<select id="myComboBox" onchange="handleSelectChange()">
										<option value="query" selected>Query</option>
										<option value="count">Count</option>
										<option value="insert">Insert</option>
									</select>
									<p>
									<p>
									<label class="upload" id="CC" >
									  <span class="custom_button" >
										Upload CC
									  </span>
									  <input type="file" name = "CC" style="visibility:hidden; width: 0;"id="fileInput1"onchange="checkFileInput(1)">
									  <span></span>
									</label>
									<label class="upload" id="key">
									  <span class="custom_button" >
										Upload Key
									  </span>
									  <input type="file" name="key" style="visibility:hidden; width: 0;" id="fileInput2"onchange="checkFileInput(2)">
									  <span></span>
									</label>
									<label class="upload"id="CTS">
									  <span class="custom_button" >
										Upload CTS
									  </span>
									  <input type="file" name="cts" style="visibility:hidden; width: 0;"id="fileInput3"onchange="checkFileInput(3)">
									  <span></span>
									</label>
									<label class="upload" id="encdata">
									  <span class="custom_button" >
										Upload EncData
									  </span>
									  <input type="file" name="encData" style="visibility:hidden; width: 0;" id="fileInput4"onchange="checkFileInput(4)">
									  <span></span>
									</label>
									
									</form>
									<button id="upload" type = "button" disabled >
										upload
									</button>
									<script>
									  let count = [0,0,0,0];
									  let select = document.getElementById("myComboBox");     
									  function checkFileInput(inputNumber) {
										var selectedOption = select.options[select.selectedIndex].value;
										let fileInput = document.getElementById("fileInput" + inputNumber); 
										let upload = document.getElementById("upload");      
										if (fileInput.files.length > 0) {
										  count[inputNumber-1] = 1;         
										}
										if(selectedOption == "query")
										{
										  upload.disabled = false;
										  if (!count.every(element => element === 1)) 
										  {
											upload.disabled = true;
										  }
										  else
										  {
											upload.disabled = false;
										  }
										}
										else if(selectedOption == "count")
										{
										  if (!count.every(element => element === 1)) 
										  {
											upload.disabled = true;
										  }
										  else
										  {
											upload.disabled = false;
										  }
										}
										else
										{
										  for(let i = 0; i < 3; i++)
										  {
											count[i] = 0;
										  }
										  if(count[3] == 1)
										  {
											upload.disabled = false;
										  }
										  else
										  {
											upload.disabled = true;
										  }
										}
									  }
									  </script>     
									<script>
									  window.addEventListener('load', ()=>{
										document.querySelectorAll('.upload>input').forEach( element => {
										  element.addEventListener('change', ({target})=>{
											if(!target.files) return
											let nextEl = target.nextElementSibling
											nextEl.innerText = target.files[0].name
										  })
										})
									  })
									</script>
								<script>
								  function handleSelectChange() {
									
									
									var select = document.getElementById("myComboBox");
									var selectedOption = select.options[select.selectedIndex].value;
								
									var fileInput1 = document.getElementById("fileInput1");
									var fileInput2 = document.getElementById("fileInput2");
									var fileInput3 = document.getElementById("fileInput3");
									var fileInput4 = document.getElementById("fileInput4");
									let upload = document.getElementById("upload");
									let labelCC = document.getElementById("CC");
									let labelkey = document.getElementById("key");
									let labelcts = document.getElementById("CTS");
									let downloadButton = document.getElementById("downloadBtn");
									
									if (selectedOption === "query") {
										downloadBtn.disabled = true;
										upload.disabled = false;
										if (fileInput1.files.length > 0 && fileInput2.files.length > 0 && fileInput3.files.length > 0 && fileInput4.files.length > 0)
										{
											upload.disabled = false;
										}
										else
										{
											upload.disabled = true;
										}
										labelCC.style.visibility = "visible";
										labelkey.style.visibility = "visible";
										labelcts.style.visibility = "visible";
										fileInput1.disabled = false;
										fileInput2.disabled = false;
										fileInput3.disabled = false;
										fileInput4.disabled = false;
									} else if (selectedOption === "count") {
										downloadBtn.disabled = true;
										if (fileInput1.files.length > 0 && fileInput2.files.length > 0 && fileInput3.files.length > 0 && fileInput4.files.length > 0)
										{
											upload.disabled = false;
										}
										else
										{
											upload.disabled = true;
										}
										labelCC.style.visibility = "visible";
										labelkey.style.visibility = "visible";
										labelcts.style.visibility = "visible";
										fileInput1.disabled = false;
										fileInput2.disabled = false;
										fileInput3.disabled = false;
										fileInput4.disabled = false;
									} else if (selectedOption === "insert") {
										downloadBtn.disabled = true;
										if (fileInput4.files.length > 0)
										{
											upload.disabled = false;
										}
										else
										{
											upload.disabled = true;
										}
										labelCC.style.visibility = "hidden";
										labelkey.style.visibility = "hidden";
										labelcts.style.visibility = "hidden";
										fileInput1.disabled = true;
										fileInput2.disabled = true;
										fileInput3.disabled = true;
										fileInput4.disabled = false;
									}
								  }
								</script>
							</div>
							<div class="inner">
								<br>
								<h2>資料下載</h2>
								<p></p>
								<button id="downloadBtn" disabled>download </button>
								<script>
								let downloadBtn = document.getElementById('downloadBtn')
									downloadBtn.addEventListener('click', ()=>{
										window.location.href = '/download'
									})
								</script>
								</div>					
						</header>
						

						<!-- Content -->
							
		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>