<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<script src="https://code.jquery.com/jquery-3.7.0.min.js" integrity="sha256-2Pmvv0kuTBOenSvLm6bvfBSSHrUJ+3A7x6P5Ebd07/g=" crossorigin="anonymous"></script>
		<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
		<script src="upload.js"></script>
		<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
		<title>文件上傳下載</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<style>
			.upload>span:first-child{   
				color:rgb(248, 242, 242);
				border-radius: 5px;
				padding: 5px 10px;
				background-color: rgb(60, 6, 148);
			}
			.upload>span:first-child:hover{
				background-color: rgb(15, 15, 15);
				color: rgb(226, 223, 24);
			}
			/* add by leo */
			.upload>span:last-child{
				display: none;
				width: 2.5em;
				height: 2.5em;
				vertical-align: bottom;
			}
			@keyframes svgAnimation{
				from { transform:rotate(0deg);}
				to {transform:rotate(360deg);}
			}
			.upload>span:last-child:hover{
				animation-name: svgAnimation;
				animation-duration: 1s;
				
			}
			</style>
	</head>
	<body class="is-preload">

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header">
						<h1><p>TFHE-POLICE</p>
							
						</h1>
					</header>

				<!-- Menu -->
				
				
				<!-- Wrapper -->
					<section id="wrapper">
						<header>
							<div class="inner">
								<h2>使用說明</h2>
								1. 先選擇下拉式選單要執行的選項
								<br><br>
								2. 之後上傳所需要的檔案
								<br><br>
								3. 上傳完之後即可下載所需要的檔案
								<br><br>
								<h2>資料上傳</h2>
								
								  <form action="/uploads" method="post" enctype="multipart/form-data"id="form" name="form1">
									<p></p>
									<select id="myComboBox" onchange="handleSelectChange()">
										<option value="query" selected>Query</option>
										<option value="count">Count</option>
										<option value="insert">Insert</option>
									</select>
									<p>
									<p>
									<label class="upload" id="CC" >
									  <span class="custom_button" >
										Upload CC
									  </span>
									  <input type="file" name = "CC" style="visibility:hidden; width: 0;"id="fileInput1"onchange="checkFileInput(1)">
									  <span></span>
									  <span></span>
									</label>
									<label class="upload" id="key">
									  <span class="custom_button" >
										Upload Key
									  </span>
									  <input type="file" name="key" style="visibility:hidden; width: 0;" id="fileInput2"onchange="checkFileInput(2)">
									  <span></span>
									  <span></span>
									</label>
									<label class="upload"id="encdata">
									  <span class="custom_button" >
										Upload EncData.zip
									  </span>
									  <input type="file" name="encData.zip" style="visibility:hidden; width: 0;"id="fileInput3"onchange="checkFileInput(3)">
									  <span></span>
									  <span></span>
									</label>
									<label class="upload" id="CTS">
									  <span class="custom_button" id = insert.zip>
										Upload CTS.zip
									  </span>
									  <input type="file" name="cts.zip" style="visibility:hidden; width: 0;" id="fileInput4"onchange="checkFileInput(4)">
									  <span></span>
									  <span></span>
									</label>
									
									</form>
									<script>
										window.addEventListener('load', ()=>{
											document.querySelectorAll('.upload>input').forEach( input => {
											  let textSpan = input.nextElementSibling
											  let closeBtn = input.nextElementSibling.nextElementSibling
											  closeBtn.innerHTML = '<svg viewBox="-2.4 -2.4 28.80 28.80" fill="none" xmlns="http://www.w3.org/2000/svg" stroke="#ffffff"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <path d="M14.5 9.50002L9.5 14.5M9.49998 9.5L14.5 14.5" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> <path d="M7 3.33782C8.47087 2.48697 10.1786 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 10.1786 2.48697 8.47087 3.33782 7" stroke="#ffffff" stroke-width="1.5" stroke-linecap="round"></path> </g></svg>'
											  
											  input.addEventListener('change', ({target})=>{
												if(target.files.length===0) return
												textSpan.innerText = target.files[0].name
												closeBtn.style.display = 'inline-block'
											  })
											  closeBtn.addEventListener("click", (e)=>{
												e.preventDefault()
												input.value = ''
												textSpan.innerText = ""
												closeBtn.style.display = 'none'
												input.dispatchEvent(new Event('change'))
											  })
											})
										})
										</script>
									<button id="upload" type = "button" disabled >
										upload
									</button>
									<script>
									  let count = [0,0,0,0];
									  let select = document.getElementById("myComboBox");     
									  function checkFileInput(inputNumber) {
										var selectedOption = select.options[select.selectedIndex].value;
										let fileInput = document.getElementById("fileInput" + inputNumber); 
										let upload = document.getElementById("upload");      
										if (fileInput.files.length > 0) {
										  count[inputNumber-1] = 1;         
										}
										if(selectedOption == "query")
										{
										  upload.disabled = false;
										  if (count[3] != 1) 
										  {
											upload.disabled = true;
										  }
										  else
										  {
											upload.disabled = false;
										  }
										}
										else if(selectedOption == "count")
										{
										  if (count[3] != 1) 
										  {
											upload.disabled = true;
										  }
										  else
										  {
											upload.disabled = false;
										  }
										}
										else
										{

										  if(count[3] == 1 || (count[2] == 1 && count[3] == 1))
										  {
											upload.disabled = false;
										  }
										  else
										  {
											upload.disabled = true;
										  }
										}
									  }
									  </script>     
									<script>
									  window.addEventListener('load', ()=>{
										document.querySelectorAll('.upload>input').forEach( element => {
										  element.addEventListener('change', ({target})=>{
											if(!target.files) return
											let nextEl = target.nextElementSibling
											nextEl.innerText = target.files[0].name
										  })
										})
									  })
									</script>
								<script>
								  function handleSelectChange() {
									
									
									var select = document.getElementById("myComboBox");
									var selectedOption = select.options[select.selectedIndex].value;
								
									var fileInput1 = document.getElementById("fileInput1");
									var fileInput2 = document.getElementById("fileInput2");
									var fileInput3 = document.getElementById("fileInput3");
									var fileInput4 = document.getElementById("fileInput4");
									let upload = document.getElementById("upload");
									let labelCC = document.getElementById("CC");
									let labelkey = document.getElementById("key");
							
									let downloadButton = document.getElementById("downloadBtn");
									const customButton = document.getElementById("insert.zip")
									if (selectedOption === "query") {
										downloadBtn.disabled = true;
										upload.disabled = false;
										customButton.textContent = 'upload cts.zip';
										if (fileInput4.files.length > 0)
										{
											upload.disabled = false;
										}
										else
										{
											upload.disabled = true;
										}
										labelCC.style.visibility = "visible";
										labelkey.style.visibility = "visible";
									
										fileInput1.disabled = false;
										fileInput2.disabled = false;
										fileInput3.disabled = false;
										fileInput4.disabled = false;
									} else if (selectedOption === "count") {
										downloadBtn.disabled = true;
															
										customButton.textContent = 'upload cts.zip';

										
										if (fileInput4.files.length > 0)
										{
											upload.disabled = false;
										}
										else
										{
											upload.disabled = true;
										}
										labelCC.style.visibility = "visible";
										labelkey.style.visibility = "visible";
									
										fileInput1.disabled = false;
										fileInput2.disabled = false;
										fileInput3.disabled = false;
										fileInput4.disabled = false;
									} else if (selectedOption === "insert") {
										customButton.textContent = 'upload Insert.zip';
										downloadBtn.disabled = true;
					
										if (fileInput4.files.length > 0)
										{
											upload.disabled = false;
										}
										else
										{
											upload.disabled = true;
										}
										labelCC.style.visibility = "hidden";
										labelkey.style.visibility = "hidden";
								
										fileInput1.disabled = true;
										fileInput2.disabled = true;
										fileInput3.disabled = false;
										fileInput4.disabled = false;
									}
								  }
								</script>
							</div>
							<div class="inner">
								<br>
								<h2>資料下載</h2>
								<p></p>
								<button id="downloadBtn" disabled>download </button>
								<script>
								let submitButton = document.getElementById("upload");
								
								let downloadBtn = document.getElementById('downloadBtn')
								
								submitButton.addEventListener('click', () => {
									let combobox = document.getElementById('myComboBox').value;
									downloadBtn.addEventListener('click', ()=>{
										if(combobox == "query")
										{
											window.location.href = '/downloadquery'
										}
										else if(combobox == "count")
										{
											window.location.href = '/downloadcount'
										}
									})						
								});
								</script>
								</div>					
						</header>
						

						<!-- Content -->
							
		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>